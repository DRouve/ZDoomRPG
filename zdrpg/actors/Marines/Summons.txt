ACTOR DRPGMarineGuardPistolSummoned
{
  Health 200
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  +FRIENDLY
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound ""
  PainSound "drpgmarinemale2/pain"
  DeathSound "drpgmarinemale2/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA2 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarinePistolShotCounter", 6, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA2 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA2 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA2 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA2 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA2 E 0 A_Look
    NMA2 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA2 EEE 6 A_Stop
    NMA2 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA2 A 0 A_Look
    NMA2 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA2 EEE 4 A_Stop
    NMA2 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA2 A 0 A_Look
    NMA2 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 64, "TacticReload")
    NMA2 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (128, 2)
    TNT1 A 0 A_Jump (96, "Reload")
    NMA2 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (96, 2)
    TNT1 A 0 A_Jump (128, "Reload")
    NMA2 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (64, 2)
    TNT1 A 0 A_Jump (160, "Reload")
    NMA2 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA2 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (32, 2)
    TNT1 A 0 A_Jump (192, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_Jump (32, "TacticStrafe")
    TNT1 A 0 A_JumpIfInventory ("DRPGMarinePistolShotCounter", 6, "RetreatReload")
    NMA2 EEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_GiveInventory ("DRPGMarinePistolShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/pistol", CHAN_WEAPON, 1, 0, 0.8)
    NMA2 F 4 Bright A_CustomBulletAttack (6, 0, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA2 E 5
    TNT1 A 0 A_JumpIfInventory ("DRPGMarinePistolShotCounter", 6, "RetreatReload")
    NMA2 E 1 A_MonsterRefire (0, "Overwatch")
    Goto Missile
  Reload:
    NMA2 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadout", 7)
    NMA2 EE 4
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadin", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarinePistolShotCounter", 6)
    NMA2 EEEE 4
    NMA2 E 3
    TNT1 A 0 A_PlaySound("drpgmarines/pistolcock", 7)
    NMA2 E 6
    Goto See+2
  TacticReload:
    TNT1 A 0 A_Jump(128, 3)
    NMA2 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA2 E 1 A_FaceTarget
    NMA2 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadout", 7)
    NMA2 EE 4
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadin", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarinePistolShotCounter", 6)
    NMA2 EEEE 4
    NMA2 E 3
    TNT1 A 0 A_PlaySound("drpgmarines/pistolcock", 7)
    NMA2 E 6
    Goto See+2
  ForceReload:
    TNT1 A 0 A_TakeInventory ("DRPGMarineForceReloadCounter", 5)
    TNT1 A 0 A_Jump(128, 3)
    NMA2 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA2 E 1 A_FaceTarget
    NMA2 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadout", 7)
    NMA2 EE 4
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadin", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarinePistolShotCounter", 6)
    NMA2 EEEE 4
    NMA2 E 3
    TNT1 A 0 A_PlaySound("drpgmarines/pistolcock", 7)
    NMA2 E 6
    Goto See+2
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA2 AABBCCDD 1 A_Recoil(-1)
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA2 AABBCCDD 1 A_Recoil(-1)
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA2 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA2 AABBCCDD 1 A_Recoil(-1)
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA2 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack1:
    NMA2 E 1 A_FaceTarget
    NMA2 AABBCCDD 1 A_Recoil(1)
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack2:
    NMA2 E 1 A_FaceTarget
    NMA2 AABBCCDD 1 A_Recoil(random(1,2))
    NMA2 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarinePistolShotCounter", 4, "RetreatReload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA2 E 4 A_FaceTarget
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA2 E 4 A_FaceTarget
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See+2
  Pain:
    NMA2 G 3
    NMA2 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA2 H 4
    NMA2 I 4 A_Scream
    NMA2 J 4 A_NoBlocking
    NMA2 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA2 LM 4
    NMA2 N -1
    Stop
  XDeath:
    NMA2 O 4
    NMA2 P 4 A_XScream
    NMA2 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA2 RSTUV 4
    NMA2 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineBattleRifleSummoned
{
  Health 225
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound "drpgmarinemale2/sight"
  PainSound "drpgmarinemale2/pain"
  DeathSound "drpgmarinemale2/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA1 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA1 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA1 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA1 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA1 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA1 E 0 A_Look
    NMA1 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA1 EEE 6 A_Stop
    NMA1 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA1 A 0 A_Look
    NMA1 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA1 EEE 4 A_Stop
    NMA1 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA1 A 0 A_Look
    NMA1 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 64, "TacticReload")
    NMA1 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (128, 2)
    TNT1 A 0 A_Jump (96, "Reload")
    NMA1 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (96, 2)
    TNT1 A 0 A_Jump (128, "Reload")
    NMA1 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (64, 2)
    TNT1 A 0 A_Jump (160, "Reload")
    NMA1 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA1 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (32, 2)
    TNT1 A 0 A_Jump (192, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (220, 7)
    NMA1 EEEEEEEEEE 1 A_FaceTarget (10)
  MissileCheck:
    TNT1 A 0 A_Jump(64, "TacticStrafe")
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfCloser (700, 1)
    Goto MissileSnipe
    TNT1 A 0 A_JumpIfCloser (220, 1)
    Goto MissileBurst
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (16, 4, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_MonsterRefire(80, "Overwatch")
    Goto MissileCheck
  MissileBurst:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (12, 1, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(128, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (12, 1, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(144, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (14, 2, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(160, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (14, 2, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(176, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (15, 3, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(192, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (15, 3, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(208, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (16, 4, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    TNT1 A 0 A_Jump(224, 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (16, 4, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_FaceTarget
    NMA1 EEEEEEEEEE 1 A_FaceTarget (10)
    NMA1 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  MissileSnipe:
    TNT1 A 0 A_Jump (256,1,10,15,20,25)
    NMA1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 20, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineBattleRifleShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifle", CHAN_WEAPON, 1, 0, 0.7)
    NMA1 F 3 Bright A_CustomBulletAttack (12, 1, 1, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA1 E 1 A_MonsterRefire(0, "Overwatch")
    Goto MissileCheck
  Reload:
    NMA1 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NMA1 EEEEEEEE 4
    NMA1 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NMA1 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NMA1 EEEEEE 1 A_FaceTarget (10)
    Goto See
  TacticReload:
    TNT1 A 0 A_Jump(128, 3)
    NMA1 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA1 E 1 A_FaceTarget
    NMA1 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NMA1 EEEEEEEE 4
    NMA1 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NMA1 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NMA1 EEEEEE 1 A_FaceTarget (10)
    Goto See
  ForceReload:
    TNT1 A 0 A_TakeInventory ("DRPGMarineForceReloadCounter", 5)
    TNT1 A 0 A_Jump(128, 3)
    NMA1 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA1 E 1 A_FaceTarget
    NMA1 EE 4
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleunload", 7)
    NMA1 EEEEEEEE 4
    NMA1 E 2
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/battlerifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBattleRifleShotCounter", 20)
    NMA1 EE 5
    TNT1 A 0 A_PlaySound("drpgmarines/battleriflecock", 5)
    NMA1 EEEEEE 1 A_FaceTarget (10)
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto MissileCheck
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA1 AABBCCDD 1 A_Recoil(-1)
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA1 AABBCCDD 1 A_Recoil(-1)
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA1 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA1 AABBCCDD 1 A_Recoil(-1)
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA1 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeBack1:
    NMA1 E 1 A_FaceTarget
    NMA1 AABBCCDD 1 A_Recoil(1)
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeBack2:
    NMA1 E 1 A_FaceTarget
    NMA1 AABBCCDD 1 A_Recoil(random(1,2))
    NMA1 E 1 A_FaceTarget
    Goto MissileCheck
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBattleRifleShotCounter", 12, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA1 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA1 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (200, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Pain:
    NMA1 G 3
    NMA1 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA1 H 4
    NMA1 I 4 A_Scream
    NMA1 J 4 A_NoBlocking
    NMA1 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA1 LM 4
    NMA1 N -1
    Stop
  XDeath:
    NMA1 O 4
    NMA1 P 4 A_XScream
    NMA1 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA1 RSTUV 4
    NMA1 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineShotgunSummoned
{
  Health 250
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound "drpgmarinemale2/sight"
  PainSound "drpgmarinemale2/pain"
  DeathSound "drpgmarinemale2/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA3 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA3 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA3 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA3 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA3 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA3 E 0 A_Look
    NMA3 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA3 EEE 6 A_Stop
    NMA3 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA3 A 0 A_Look
    NMA3 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA3 EEE 4 A_Stop
    NMA3 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA3 A 0 A_Look
    NMA3 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_Jump(32, "TacticReload")
    NMA3 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA3 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "Reload")
    Goto RetreatReload
  Missile:
    TNT1 A 0 A_Jump (32, "TacticStrafe")
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    TNT1 A 0 A_JumpIfHealthLower (30, 2)
    TNT1 A 0 A_JumpIfCloser (600, 1)
    Goto MissileCrouch
    NMA3 EEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_MonsterRefire (0, "Overwatch")
    TNT1 A 0 A_GiveInventory ("DRPGMarineShotgunShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/shotgun", CHAN_WEAPON, 1, 0, 0.7)
    NMA3 F 4 Bright A_CustomBulletAttack (16, 4, 5, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA3 E 6
    TNT1 A 0 A_JumpIfHealthLower (30, 2)
    TNT1 A 0 A_Jump (64, "RetreatReload")
    TNT1 A 0
    Goto Reload
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "Reload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA3 E 4 A_FaceTarget
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA3 E 4 A_FaceTarget
    TNT1 A 0 A_Jump (128, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  MissileCrouch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    NMA3 XXXXXXXX 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_MonsterRefire (0, "OverwatchCrouch")
    TNT1 A 0 A_GiveInventory ("DRPGMarineShotgunShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/shotgun", CHAN_WEAPON, 1, 0, 0.7)
    NMA3 Y 4 Bright A_CustomBulletAttack (12, 2, 5, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA3 X 6
    NMA3 X 5
    Goto ReloadCrouch
  OverwatchCrouch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "Reload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_Chase ("", "MissileCrouch", CHF_DONTMOVE)
    NMA3 X 4 A_FaceTarget
    TNT1 A 0 A_Chase ("", "MissileCrouch", CHF_DONTMOVE)
    NMA3 X 4 A_FaceTarget
    TNT1 A 0 A_Jump (128, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Reload:
    NMA3 EE 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("drpgmarines/shotgunpump", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    NMA3 EE 4 A_FaceTarget
    NMA3 EE 4 A_FaceTarget
    Goto Missile
  TacticReload:
    TNT1 A 0 A_JumpIfCloser (600, 1)
    Goto TacticReloadCrouch
    NMA3 E 1 A_FaceTarget (0, 30, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA3 E 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("drpgmarines/shotgunpump", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    NMA3 EE 4 A_FaceTarget
    NMA3 EE 4 A_FaceTarget
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA3 AABBCCDD 1 A_Recoil(-1)
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA3 AABBCCDD 1 A_Recoil(-1)
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA3 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA3 AABBCCDD 1 A_Recoil(-1)
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA3 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack1:
    NMA3 E 1 A_FaceTarget
    NMA3 AABBCCDD 1 A_Recoil(1)
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack2:
    NMA3 E 1 A_FaceTarget
    NMA3 AABBCCDD 1 A_Recoil(random(1,2))
    NMA3 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  ReloadCrouch:
    NMA3 XX 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("drpgmarines/shotgunpump", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    NMA3 XX 4 A_FaceTarget
    NMA3 XX 4 A_FaceTarget
    Goto Missile
  TacticReloadCrouch:
    NMA3 X 1 A_FaceTarget (0, 30, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA3 X 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("drpgmarines/shotgunpump", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    NMA3 XX 4 A_FaceTarget
    NMA3 XX 4 A_FaceTarget
    Goto See
  Pain:
    NMA3 G 3
    NMA3 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA3 H 4
    NMA3 I 4 A_Scream
    NMA3 J 4 A_NoBlocking
    NMA3 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA3 LM 4
    NMA3 N -1
    Stop
  XDeath:
    NMA3 O 4
    NMA3 P 4 A_XScream
    NMA3 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA3 RSTUV 4
    NMA3 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineDoubleShotgunSummoned
{
  Health 275
  GibHealth -50
  Radius 20
  Height 56
  Speed 8
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound "drpgmarinemale1/sight"
  PainSound "drpgmarinemale1/pain"
  DeathSound "drpgmarinemale1/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA4 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA4 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA4 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA4 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA4 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA4 E 0 A_Look
    NMA4 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA4 EEE 6 A_Stop
    NMA4 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA4 A 0 A_Look
    NMA4 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA4 EEE 4 A_Stop
    NMA4 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA4 A 0 A_Look
    NMA4 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_Jump(64, "TacticReload")
    NMA4 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA4 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "Reload")
    Goto RetreatReload
  Missile:
    TNT1 A 0 A_Jump (64, "TacticStrafe")
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    NMA4 EEEEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_MonsterRefire (0, "Overwatch")
    TNT1 A 0 A_GiveInventory ("DRPGMarineShotgunShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgun", CHAN_WEAPON, 1, 0, 0.7)
    NMA4 F 4 Bright A_CustomBulletAttack (16, 5, 12, random(1,5) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA4 E 6
    TNT1 A 0 A_JumpIfHealthLower (30, 2)
    TNT1 A 0
    Goto Missile
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "Reload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA4 E 4 A_FaceTarget
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA4 E 4 A_FaceTarget
    TNT1 A 0 A_Jump (128, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Reload:
    NMA4 EE 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgunopen", 7)
    NMA4 E 21 A_FaceTarget
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgunload", 7)
    NMA4 E 18 A_FaceTarget
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgunclose", 7)
    NMA4 E 4 A_FaceTarget
    Goto Missile
  TacticReload:
    NMA4 E 1 A_FaceTarget (0, 30, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA4 E 1 A_FaceTarget
    NMA4 EE 7
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgunopen", 7)
    NMA4 E 21
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgunload", 7)
    NMA4 E 18
    TNT1 A 0 A_PlaySound("drpgmarines/doubleshotgunclose", 7)
    NMA4 E 5 A_FaceTarget
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA4 AABBCCDD 1 A_Recoil(-1)
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA4 AABBCCDD 1 A_Recoil(-1)
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA4 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA4 AABBCCDD 1 A_Recoil(-1)
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA4 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack1:
    NMA4 E 1 A_FaceTarget
    NMA4 AABBCCDD 1 A_Recoil(1)
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack2:
    NMA4 E 1 A_FaceTarget
    NMA4 AABBCCDD 1 A_Recoil(random(1,2))
    NMA4 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Pain:
    NMA4 G 3
    NMA4 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA4 H 4
    NMA4 I 4 A_Scream
    NMA4 J 4 A_NoBlocking
    NMA4 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA4 LM 4
    NMA4 N -1
    Stop
  XDeath:
    NMA4 O 4
    NMA4 P 4 A_XScream
    NMA4 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA4 RSTUV 4
    NMA4 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineChaingunSummoned
{
  Health 300
  GibHealth -50
  Radius 20
  Height 56
  Speed 6
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound "drpgmarinemale3/sight"
  PainSound "drpgmarinemale3/pain"
  DeathSound "drpgmarinemale3/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA6 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounterSummoned", 80, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA6 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA6 X 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA6 XXX 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA6 XXX 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA6 X 0 A_Look
    NMA6 X 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA6 XXX 6 A_Stop
    NMA6 XXX 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA6 A 0 A_Look
    NMA6 X 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA6 XXX 4 A_Stop
    NMA6 XXX 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA6 A 0 A_Look
    NMA6 X 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 64, "TacticReload")
    NMA6 X 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (128, 2)
    TNT1 A 0 A_Jump (96, "Reload")
    NMA6 X 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (96, 2)
    TNT1 A 0 A_Jump (128, "Reload")
    NMA6 X 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (64, 2)
    TNT1 A 0 A_Jump (160, "Reload")
    NMA6 X 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA6 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (32, 2)
    TNT1 A 0 A_Jump (192, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    NMA6 XXXXX 1 A_FaceTarget (10)
    TNT1 A 0 A_Jump (4, "TacticStrafe")
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounterSummoned", 80, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineChaingunShotCounterSummoned", 1)
    TNT1 A 0 A_PlaySound("drpgmarines/chaingun", CHAN_WEAPON, 1, 0, 0.7)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunStateCounter", 1, "MissileAlt")
    TNT1 A 0 A_GiveInventory ("DRPGMarineChaingunStateCounter", 1)
    NMA6 F 3 Bright A_CustomBulletAttack (12, 2, 1, random(2,6) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA6 X 1 A_MonsterRefire(30, "Overwatch")
    Goto Missile+5
  MissileAlt:
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunStateCounter", 1)
    NMA6 E 3 Bright A_CustomBulletAttack (12, 2, 1, random(2,6) * 3, "DRPGMarineBulletPuffSummoned", 0, CBAF_NORANDOM)
    NMA6 X 1 A_MonsterRefire(30, "Overwatch")
    Goto Missile+5
  Reload:
    NMA6 XXX 5
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadout", 7)
    NMA6 XX 5
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounterSummoned", 80)
    NMA6 XXXXX 5
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunwinddown", 6)
    NMA6 XX 5 A_FaceTarget
    Goto See
  TacticReload:
    TNT1 A 0 A_Jump(128, 3)
    NMA6 X 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA6 X 1 A_FaceTarget
    NMA6 XXX 5
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadout", 7)
    NMA6 XX 5
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounterSummoned", 80)
    NMA6 XXXXX 5
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunwinddown", 6)
    NMA6 XX 5 A_FaceTarget
    Goto See
  ForceReload:
    TNT1 A 0 A_TakeInventory ("DRPGMarineForceReloadCounter", 5)
    TNT1 A 0 A_Jump(128, 3)
    NMA6 X 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA6 X 1 A_FaceTarget
    NMA6 XXX 5
    TNT1 A 0 A_PlaySound("drpgmarines/pistolreloadout", 7)
    NMA6 XX 5
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounterSummoned", 80)
    NMA6 XXXXX 5
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunwinddown", 6)
    NMA6 XX 5 A_FaceTarget
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA6 AABBCCDD 1 A_Recoil(-1)
    NMA6 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA6 AABBCCDD 1 A_Recoil(-1)
    NMA6 X 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA6 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA6 X 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA6 AABBCCDD 1 A_Recoil(-1)
    NMA6 X 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA6 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA6 X 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack1:
    NMA6 X 1 A_FaceTarget
    NMA6 AABBCCDD 1 A_Recoil(1)
    NMA6 X 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack2:
    NMA6 X 1 A_FaceTarget
    NMA6 AABBCCDD 1 A_Recoil(random(1,2))
    NMA6 X 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Overwatch:
    TNT1 A 0 A_PlaySound("drpgmarines/chaingunwinddown", 6)
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounterSummoned", 50, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA6 X 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA6 X 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (64, 1)
    Goto Overwatch+1
    TNT1 A 0
    Goto See
  Pain:
    NMA6 G 3
    NMA6 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA6 H 4
    NMA6 I 4 A_Scream
    NMA6 J 4 A_NoBlocking
    NMA6 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA6 LM 4
    NMA6 N -1
    Stop
  XDeath:
    NMA6 O 4
    NMA6 P 4 A_XScream
    NMA6 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA6 RSTUV 4
    NMA6 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

ACTOR DRPGMarineRocketLauncherSummoned
{
  Health 325
  GibHealth -50
  Radius 20
  Height 56
  Speed 7
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  DamageFactor "Fire", 0.5
  SeeSound "drpgmarinemale1/sight"
  PainSound "drpgmarinemale1/pain"
  DeathSound "drpgmarinemale1/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA7 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA7 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA7 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA7 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA7 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA7 E 0 A_Look
    NMA7 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA7 EEE 6 A_Stop
    NMA7 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA7 A 0 A_Look
    NMA7 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA7 EEE 4 A_Stop
    NMA7 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA7 A 0 A_Look
    NMA7 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_Jump(64, "TacticReload")
    NMA7 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA7 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "Reload")
    Goto RetreatReload
  Missile:
    TNT1 A 0 A_Jump (64, "TacticStrafe")
    TNT1 A 0 A_Jump (128, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump (128, "TacticStrafeRight1")
    TNT1 A 0 A_Jump (64, "TacticStrafe")
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "RetreatReload")
    TNT1 A 0 A_JumpIfCloser (160, "JumpBack")
    NMA7 EEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
  MissileFuckYou:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_MonsterRefire (0, "Overwatch")
    TNT1 A 0 A_GiveInventory ("DRPGMarineShotgunShotCounter", 1)
    TNT1 A 0 A_TakeInventory ("DRPGMarineJumpCounter", 4)
    NMA7 F 10 Bright A_CustomMissile ("DRPGMarineRocketSummoned", 40, 11, frandom(1,-1), CMF_OFFSETPITCH, frandom(1,-1))
    NMA7 E 8
    TNT1 A 0 A_JumpIfHealthLower (30, 2)
    TNT1 A 0 A_Jump (64, "RetreatReload")
    TNT1 A 0
    Goto Reload
  JumpBack:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineJumpCounter", 4, "MissileFuckYou")
    TNT1 A 0 A_GiveInventory ("DRPGMarineJumpCounter", 1)
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    NMA7 EEEEEEEEE 1 A_FaceTarget (10)
    Goto Missile
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineShotgunShotCounter", 1, "Reload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA7 E 4 A_FaceTarget
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA7 E 4 A_FaceTarget
    TNT1 A 0 A_Jump (32, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Reload:
    NMA7 E 45
    TNT1 A 0 A_PlaySound("drpgmarines/rocketlauncherload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    NMA7 E 19
    Goto See
  TacticReload:
    NMA7 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA7 E 1 A_FaceTarget
    NMA7 E 45
    TNT1 A 0 A_PlaySound("drpgmarines/rocketlauncherload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineShotgunShotCounter", 1)
    NMA7 E 19
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile+3
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA7 AABBCCDD 1 A_Recoil(-1)
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA7 AABBCCDD 1 A_Recoil(-1)
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA7 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA7 AABBCCDD 1 A_Recoil(-1)
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA7 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeBack1:
    NMA7 E 1 A_FaceTarget
    NMA7 AABBCCDD 1 A_Recoil(1)
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeBack2:
    NMA7 E 1 A_FaceTarget
    NMA7 AABBCCDD 1 A_Recoil(random(1,2))
    NMA7 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Pain:
    NMA7 G 3
    NMA7 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA7 H 4
    NMA7 I 4 A_Scream
    NMA7 J 4 A_NoBlocking
    NMA7 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA7 LM 4
    NMA7 N -1
    Stop
  XDeath:
    NMA7 O 4
    NMA7 P 4 A_XScream
    NMA7 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA7 RSTUV 4
    NMA7 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}


ACTOR DRPGMarinePlasmaRifleSummoned
{
  Health 350
  GibHealth -50
  Radius 20
  Height 56
  Speed 6
  PainChance 192
  DamageFactor "Crush", 10
  DamageFactor "Plasma", 0.6
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound "drpgmarinemale3/sight"
  PainSound "drpgmarinemale3/pain"
  DeathSound "drpgmarinemale3/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA8 E 0 A_Look
    Goto FollowPlayer
  See:    
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 40, "RetreatReload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_JumpIfTargetInLOS (2, 0)
    TNT1 A 0 A_JumpIfCloser (300, "Ambushing")
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA8 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA8 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA8 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA8 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA8 E 0 A_Look
    NMA8 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA8 EEE 6 A_Stop
    NMA8 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA8 A 0 A_Look
    NMA8 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA8 EEE 4 A_Stop
    NMA8 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA8 A 0 A_Look
    NMA8 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  RetreatReload:
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 64, "TacticReload")
    NMA8 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (128, 2)
    TNT1 A 0 A_Jump (96, "Reload")
    NMA8 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (96, 2)
    TNT1 A 0 A_Jump (128, "Reload")
    NMA8 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (64, 2)
    TNT1 A 0 A_Jump (160, "Reload")
    NMA8 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-1)
    NMA8 AAAAABBBBBCCCCCDDDDD 1 A_Chase ("", "")
    TNT1 A 0 A_GiveInventory ("DRPGMarineForceReloadCounter", random(1,2))
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineForceReloadCounter", 5, "ForceReload")
    TNT1 A 0 A_JumpIfCloser (32, 2)
    TNT1 A 0 A_Jump (192, "Reload")
    TNT1 A 0
    Goto RetreatReload+1
  Missile:
    TNT1 A 0 A_JumpIfCloser (700, 1)
    Goto MissileCrouch
    NMA8 EEEEEEEEEE 1 A_FaceTarget (10)
    TNT1 A 0 A_Jump (20, "TacticStrafe")
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 40, "RetreatReload")
    TNT1 A 0 A_GiveInventory ("DRPGMarineChaingunShotCounter", 1)
    NMA8 F 2 Bright A_CustomMissile ("DRPGMarinePlasmaBallSummoned", 28, 11, frandom(1,-1), CMF_OFFSETPITCH, frandom(1,-1))
    NMA8 E 1 A_MonsterRefire(30, "Overwatch")
    Goto Missile+11
  Reload:
    NMA8 E 24
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleunload", 7)
    NMA8 E 9 A_FaceTarget
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounter", 40)
    NMA8 E 24 A_FaceTarget
    Goto See
  TacticReload:
    TNT1 A 0 A_Jump(128, 3)
    NMA8 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA8 E 4 A_FaceTarget
    NMA8 E 24
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleunload", 7)
    NMA8 E 9 A_FaceTarget
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounter", 40)
    NMA8 E 24 A_FaceTarget
    Goto See
  ForceReload:
    TNT1 A 0 A_TakeInventory ("DRPGMarineForceReloadCounter", 5)
    TNT1 A 0 A_Jump(128, 3)
    NMA8 E 1 A_FaceTarget (0, 90, random(90, 270), 0, 0)
    TNT1 A 0 A_Recoil(-random(3,8))
    NMA8 E 4 A_FaceTarget
    NMA8 E 24
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleunload", 7)
    NMA8 E 9 A_FaceTarget
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounter", 40)
    NMA8 E 24 A_FaceTarget
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA8 AABBCCDD 1 A_Recoil(-1)
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA8 AABBCCDD 1 A_Recoil(-1)
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA8 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA8 AABBCCDD 1 A_Recoil(-1)
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA8 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack1:
    NMA8 E 1 A_FaceTarget
    NMA8 AABBCCDD 1 A_Recoil(1)
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack2:
    NMA8 E 1 A_FaceTarget
    NMA8 AABBCCDD 1 A_Recoil(random(1,2))
    NMA8 E 1 A_FaceTarget
    Goto Missile
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 25, "Reload")
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA8 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA8 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (64, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  MissileCrouch:
    TNT1 A 0 A_JumpIfCloser (700, "Missile")
    NMA8 XXXXXXXXXX 1 A_FaceTarget (10)
    TNT1 A 0 A_Jump (20, "TacticStrafe")
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 40, "ReloadCrouch")
    TNT1 A 0 A_GiveInventory ("DRPGMarineChaingunShotCounter", 1)
    NMA8 Y 2 Bright A_CustomMissile ("DRPGMarinePlasmaBallSummoned", 15, 8, 0)
    NMA8 X 1 A_MonsterRefire(30, "Overwatch")
    Goto MissileCrouch+11
  ReloadCrouch:
    NMA8 E 24
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleunload", 7)
    NMA8 E 9 A_FaceTarget
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_PlaySound("drpgmarines/plasmarifleload", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineChaingunShotCounter", 40)
    NMA8 E 24 A_FaceTarget
    Goto See
  OverwatchCrouch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 25, "Reload")
    TNT1 A 0 A_Chase ("", "MissileCrouch", CHF_DONTMOVE)
    NMA8 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "MissileCrouch", CHF_DONTMOVE)
    NMA8 E 5 A_FaceTarget (10)
    TNT1 A 0 A_Jump (128, 1)
    Goto OverwatchCrouch
    TNT1 A 0
    Goto See
  Ambushing:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 40, "Reload")
    TNT1 A 0 A_Chase ("", "MissileSpray", CHF_DONTMOVE)
    NMA8 X 1 A_FaceTarget (10)
    TNT1 A 0 A_Chase ("", "MissileSpray", CHF_DONTMOVE)
    NMA8 X 1 A_FaceTarget (10)
    TNT1 A 0 A_JumpIfCloser (500, "Ambushing")
    Goto See
  MissileSpray:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineChaingunShotCounter", 40, "ReloadCrouch")
    TNT1 A 0 A_GiveInventory ("DRPGMarineChaingunShotCounter", 1)
    NMA8 Y 2 Bright A_CustomMissile ("DRPGMarinePlasmaBallSummoned", 15, 8, frandom(9,-9), CMF_OFFSETPITCH, frandom(3,-3))
    NMA8 X 1 A_MonsterRefire(30, "Overwatch")
    Goto MissileSpray
  Pain:
    NMA8 G 3
    NMA8 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA8 H 4
    NMA8 I 4 A_Scream
    NMA8 J 4 A_NoBlocking
    NMA8 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA8 LM 4
    NMA8 N -1
    Stop
  XDeath:
    NMA8 O 4
    NMA8 P 4 A_XScream
    NMA8 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA8 RSTUV 4
    NMA8 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}


ACTOR DRPGMarineBFG9000Summoned
{
  Health 350
  GibHealth -50
  Radius 20
  Height 56
  Speed 5
  PainChance 192
  DamageFactor "Crush", 10
  Monster
  +FLOORCLIP
  +AVOIDMELEE
  -COUNTKILL
  +AMBUSH
  +NEVERRESPAWN
  +QUICKTORETALIATE
  +NOBLOCKMONST
  +NOINFIGHTING
  +DONTHARMSPECIES
  +FRIENDLY
  -SOLID
  +ALWAYSFAST
  +QUICKTORETALIATE
  +MISSILEMORE
  +MISSILEEVENMORE
  +LOOKALLAROUND
  Obituary "%o stood in the line of fire for some reason."
  Species "Player"
  Tag "Marine"
  SeeSound "drpgmarinemale2/sight"
  PainSound "drpgmarinemale2/pain"
  DeathSound "drpgmarinemale2/death"
  ActiveSound "drpgmarinemale/active"
  AttackSound ""
  States
  {
  Spawn:
    TNT1 A 0 NoDelay ACS_NamedExecuteAlways("MonsterInit", 0, MF_NOPAYKILL | MF_NODROPS | MF_NAMEGEN)
    TNT1 A 0 A_GiveInventory ("DRPGMarineSummonedToken", 1)
    NMA9 A 0 A_Look
    Goto FollowPlayer
  See:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBFG9000ShotCounterSummoned", 1, "Reload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_JumpIfHealthLower (30, "SeeScared")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    TNT1 A 0 A_CheckSight("FollowPlayer")
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    Goto See
  FollowPlayer:
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfTargetInLOS("See")
    TNT1 A 0 A_CheckSight("CheckIfPlayerSee")
    Goto FollowPlayer
  CheckIfPlayerSee:
    TNT1 A 0
    NMA9 AABBCD 0 A_FastChase
    TNT1 A 0 A_JumpIfCloser(1000, 2)
    TNT1 AAA 0
    Goto FollowPlayer
  Waits:
    TNT1 A 0 A_JumpIf(GetDistance(AAPTR_TARGET) > 200, "FollowPlayer")
    NMA9 E 1
    TNT1 A 0 A_ClearTarget
    TNT1 A 0 A_Jump(32, "Waits2")
    TNT1 A 0 A_Jump(32, "Waits3")
    TNT1 A 0 A_Jump(32, "See")
    NMA9 EEE 4 A_Stop
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA9 EEE 4 A_Stop
    TNT1 AAA 0 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA9 E 0 A_Look
    NMA9 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits2:
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA9 EEE 6 A_Stop
    NMA9 EEE 6 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA9 A 0 A_Look
    NMA9 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  Waits3:
    TNT1 A 0
    TNT1 AAA 0
    TNT1 A 0 A_SetAngle(random(90, -90) + angle)
    NMA9 EEE 4 A_Stop
    NMA9 EEE 4 A_Stop
    TNT1 A 0 A_CheckSight("FollowPlayer")
    TNT1 A 0 A_ClearTarget
    NMA9 A 0 A_Look
    NMA9 E 1 A_LookEx(0, 0, 0, 0, 0, "FollowPlayer")
    TNT1 A 0 A_CheckSIght("FollowPlayer")
    TNT1 A 0 A_CheckFlag("FRIENDLY", "Waits", AAPTR_TARGET)
    Goto FollowPlayer
  SeeScared:
    TNT1 A 0 A_JumpIfHealthLower (30, 1)
    Goto See
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 1)
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, 1)
    Goto Overwatch
    NMA9 AAAAABBBBBCCCCCDDDDD 1 A_Chase
    TNT1 A 0 A_Recoil(-1)
    TNT1 A 0 A_JumpIfCloser (1024, "SeeScared")
    Goto Overwatch
  Missile:
    TNT1 A 0 A_Jump (64, "TacticStrafe")
    TNT1 A 0 A_Jump (128, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump (128, "TacticStrafeRight1")
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBFG9000ShotCounterSummoned", 1, "Reload")
    TNT1 A 0 A_PlaySound("weapons/bfgf", CHAN_WEAPON)
    NMA9 EEEEEEEEEEEEEEEEEEEE 1 A_FaceTarget (10)
    NMA9 FFFFFFFFFF 1 Bright A_FaceTarget
    TNT1 A 0 A_GiveInventory ("DRPGMarineBFG9000ShotCounterSummoned", 1)
    NMA9 F 7 Bright A_CustomMissile ("DRPGMarineBFGBallSummoned", 40, 11, frandom(1,-1), CMF_OFFSETPITCH, frandom(1,-1))
    NMA9 E 23
    Goto See
  Overwatch:
    TNT1 A 0 A_JumpIfInventory ("DRPGMarineBFG9000ShotCounterSummoned", 1, "Reload")
    TNT1 A 0 A_ChangeFlag ("FRIGHTENED", 0)
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA9 E 4 A_FaceTarget
    TNT1 A 0 A_Chase ("", "Missile", CHF_DONTMOVE)
    NMA9 E 4 A_FaceTarget
    TNT1 A 0 A_Jump (32, 1)
    Goto Overwatch
    TNT1 A 0
    Goto See
  Reload:
    NMA9 E 40
    TNT1 A 0 A_PlaySound("drpgmarines/bfg9000unload", 7)
    NMA9 E 35
    TNT1 A 0 A_PlaySound("drpgmarines/bfg9000load", 7)
    TNT1 A 0 A_TakeInventory ("DRPGMarineBFG9000ShotCounterSummoned", 1)
    NMA9 E 27
    Goto See
  TacticStrafe:
    TNT1 A 0 A_JumpIfCloser (512, 2)
    TNT1 A 0 A_Jump(64, "TacticStrafeForward1")
    TNT1 A 0 A_JumpIfCloser (256, 6)
    TNT1 A 0 A_Jump(64, "TacticStrafeLeft1")
    TNT1 A 0 A_Jump(64, "TacticStrafeRight1")
    TNT1 A 0 A_Jump(32, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(32, "TacticStrafeRight2")
    TNT1 A 0 A_Jump(128, "TacticStrafeBack1")
    Goto Missile+3
    TNT1 A 0 A_Jump(128, "TacticStrafeLeft2")
    TNT1 A 0 A_Jump(128, "TacticStrafeRight2")
    Goto TacticStrafeBack2
  TacticStrafeForward1:
    TNT1 A 0 A_SetAngle((random(-45,45)) + angle)
    NMA9 AABBCCDD 1 A_Recoil(-1)
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeLeft1:
    TNT1 A 0 A_SetAngle(90 + angle)
    NMA9 AABBCCDD 1 A_Recoil(-1)
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeLeft2:
    TNT1 A 0 A_SetAngle((90+random(-30,30)) + angle)
    NMA9 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeRight1:
    TNT1 A 0 A_SetAngle(270 + angle)
    NMA9 AABBCCDD 1 A_Recoil(-1)
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeRight2:
    TNT1 A 0 A_SetAngle((270+random(-30,30)) + angle)
    NMA9 AABBCCDD 1 A_Recoil(-random(1,2))
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeBack1:
    NMA9 E 1 A_FaceTarget
    NMA9 AABBCCDD 1 A_Recoil(1)
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeBack2:
    NMA9 E 1 A_FaceTarget
    NMA9 AABBCCDD 1 A_Recoil(random(1,2))
    NMA9 E 1 A_FaceTarget
    Goto Missile+3
  TacticStrafeBack3:
    TNT1 A 0 A_FaceTarget
    TNT1 A 0 ThrustThing(angle*256/360+128, 8, 0, 0)
    TNT1 A 0 ThrustThingZ(0, 4, 0, 1)
    Goto See
  Pain:
    NMA9 G 3
    NMA9 G 3 A_Pain
    TNT1 A 0 A_JumpIfCloser (64, 1)
    Goto See
    TNT1 A 0 A_Jump(32, "TacticStrafe")
    TNT1 A 0 A_Jump(32, "TacticStrafeBack3")
    Goto See
  Death:
    NMA9 H 4
    TNT1 A 0 A_PlaySound("drpgmarines/smallexp", CHAN_WEAPON)
    NMA9 I 4 A_Scream
    NMA9 J 4 A_NoBlocking
    NMA9 K 4
    TNT1 A 0 A_SpawnItem ("DRPGBodyThud", 0, 0, 0, 0)
    NMA9 LM 4
    NMA9 N -1
    Stop
  XDeath:
    TNT1 A 0 A_PlaySound("drpgmarines/smallexp", CHAN_WEAPON)
    NMA9 O 4
    NMA9 P 4 A_XScream
    NMA9 Q 4 A_NoBlocking
    TNT1 A 0 A_SpawnItem ("DRPGGibThud", 0, 0, 0, 0)
    NMA9 RSTUV 4
    NMA9 W -1
    Stop
  Crush:
    TNT1 A 1 A_SpawnItem("DRPGCrushedMarine",0,0,0,0)
    Stop
  }
}

/////Replacers//////

ACTOR DRPGMarineBulletPuffSummoned : DRPGMarineBulletPuff
{
   +MTHRUSPECIES
}

ACTOR DRPGMarineRocketSummoned : Rocket
{
   +MTHRUSPECIES
}

ACTOR DRPGMarinePlasmaBallSummoned : DRPGMarinePlasmaBall
{
   +MTHRUSPECIES
}

ACTOR DRPGMarineBFGBallSummoned : BFGBall
{
    Obituary "%o was cremated to UAC standards."
    DamageType "Plasma"
    +MTHRUSPECIES
    +DONTREFLECT
    +SKYEXPLODE
    States
    {
    Spawn:
        BFS1 AB 4 Bright
        Loop
    Death:
        TNT1 A 0 A_Quake (2, 40, 0, 1024, "")
        TNT1 A 0 A_Quake (6, 32, 0, 300, "")
        BFE1 AB 8 Bright
        BFE1 C 8 Bright A_BFGSpray ("BFGExtra", 40, 10, 90, 1024, 32, 0)
        BFE1 DEF 8 Bright
        Stop
    }
}

//////Counters/////

Actor DRPGMarineChaingunShotCounterSummoned : Inventory
{
    inventory.maxamount 80
}

Actor DRPGMarineBFG9000ShotCounterSummoned : Inventory
{
    inventory.maxamount 1
}

Actor DRPGMarineForceReloadCounter : Inventory
{
    inventory.maxamount 5
}